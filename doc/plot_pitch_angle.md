# plot_pitch_angle.py

ピッチ角分布の時間変化**もどき**を計算することができます。

モデルが雑すぎてぶっちゃけ、「おもちゃ」だと思いますw。

ここで、「上」は高度が高い、「下」は高度が低いことを意味します。

説明
以下のような状況を想定したプロットです。非常に単純なモデルから作成するプロットなので、たくさんの仮定があります。
- とある、磁力線方向に高さを持った領域（以下、「電場加速領域」）で、acceleration_time秒だけ、加速のために必要な電場が発生します。その領域は、今いる地点、すなわち観測地点から「distance_accele_area_up」下に進んだ場所が電場加速領域の「上限」で、「distance_accele_area_low」下に進んだ場所が電場加速領域の「下限」です。

- その加速領域では、常に粒子が供給されます。そして、電場加速領域内のすべての場所で「常に同じだけの量の粒子が加速」されています。場所によって、より多くの粒子が加速される、といったことはありません。

- 電場加速領域で加速された粒子はミラーフォースにより、上に向かって行きます。電場加速領域では常に同じだけの量の粒子が加速され続けていますから、時間差を持って、様々な粒子が上に向かって飛んでいきます。そして、それを観測地点で見た時、どれぐらいのピッチ角の粒子がどれぐらいの密度、エネルギー密度で存在しますか、というグラフを表示します。

- 当然、電場加速領域以外の粒子の影響は加味されません。これは、以下のような仮定から導かれます。
    - 電場で加速された粒子のみが、強いエネルギーを持ち、衛星でピッチ角分布を観測される粒子になる。
    - 電場加速領域以外で加速された粒子はいない。

- 対流などは当然考えていません。電場加速領域で加速された粒子が、そのままミラーフォース以外の力は何も受けずに磁力線に沿って観測地点に飛んできます。

- **粒子が電場加速を抜けたことによって加速が停止する効果は含まれていません** すべての粒子は電場加速領域を抜ける前に、共鳴条件が破れる、という仮定を置いています。これは、共鳴条件が破れる前に粒子が磁力線に沿って進む距離が極めて短いだろう、という仮定に基づいています、が...　ぶっちゃけモデルの都合です。この仮定がどれほど正しいかは、以下の情報を参考にしてください。
    - 酸素イオンが平行方向垂直方向に0.1eVの速度を持って、磁気緯度70度、L = 10程度から加速がスタートしたとします。電場は常にコンスタントに1.0mV/mで垂直に酸素イオンを加速していきます。このとき平行方向にある速度になり、共鳴条件が破れたとします。ある速度が1eV、10eV、100eVのとき、このモデルでは...
        - 1eV
            - 加速が終わるまでに進んだ距離 17km
            - かかった時間 10s
            - 垂直方向 300eV前後まで加速
        - 10eV
            - 加速が終わるまでに進んだ距離 57km
            - かかった時間 15s
            - 垂直方向 750eV前後まで加速
        - 100eV
            - 加速が終わるまでに進んだ距離 240km
            - かかった時間 24s
            - 垂直方向 1650eV前後まで加速

    - 100eVになるまで加速しているとは考えづらい..　とか甘いこと考えておくと、200km ぐらいのスケール、あるいは電場加速領域からの距離があれば、ある程度正当化されるかもしれません。
    - この効果ちゃんと入れようと思ったら、初期位置の異なる様々な粒子を計算しなくちゃいけなくて面倒くさいので、面倒くさいんだったら、これで我慢しましょう（）。

以上です。最初に行った通り、「おもちゃ」ですが、まあ遊べるとは思います。